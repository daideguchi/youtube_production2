# PLAN_UI_WORKSPACE_CLEANUP — UI整理と辞書ハブ化

## Plan metadata
- **Plan ID**: PLAN_UI_WORKSPACE_CLEANUP
- **ステータス**: Active
- **担当/レビュー**: AI agent / Owner review
- **対象範囲 (In Scope)**: `ui/frontend` のページ/サイドバー/ルーティング整理、辞書UIの集約
- **非対象 (Out of Scope)**: バックエンドの大規模リファクタリング、データ形式の変更、既存ジョブ/パイプラインの仕様変更
- **関連 SoT/依存**: `progress/channels/*.csv`, `audio_tts_v2/data/reading_dict/*.yaml`, `audio_tts_v2/data/global_knowledge_base.json`, `ui/backend/main.py`
- **最終更新日**: 2025-12-12

## 1. 背景と目的
- 現状UIはサイドバー/各ページに機能が散在し、目的の操作までの導線が長い。
- 特に「誤読を見つけた→すぐ辞書へ登録」のような高頻度フローが埋もれている。
- まず辞書系の操作を単一ページに集約し、その上で全体のUI/ナビを整理する。

## 2. 成果物と成功条件 (Definition of Done)
- **成果物**
  - `ui/frontend/src/pages/DictionaryPage.tsx` + ルーティング/サイドバー統合
  - 既存ページから辞書操作を撤去し、Dictionaryページへ誘導（例: AudioIntegrity）
  - サイドバーのカテゴリ整理（段階的に実施）
  - 主要ページのUI/文言統一ガイド（必要なら追記）
- **成功条件**
  - 誤読登録が `Sidebar → 辞書 → 単語/読み入力 → 追加` の最短4アクションで完結
  - サイドバーの一次メニューが「頻度順・目的順」で把握できる
  - 既存フロー（企画CSV→台本→音声→サムネ/CapCut）が迷わず辿れる
  - 既存バックエンド計画（別エージェントのリファクタ）と競合しない

## 3. スコープ詳細
- **In Scope**
  - Dictionaryハブ（グローバル辞書/チャンネル辞書の統合UI）
  - サイドバー項目の整理（表示順/カテゴリ化/折り畳み）
  - 旧UI（辞書操作が散らばる箇所）の整理・誘導
- **Out of Scope**
  - `ui/backend` の構造変更・大型API整理（別計画に委ねる）
  - SoTファイル構造の再設計
  - 既存ページの機能追加（必要最小限の修正のみ）

## 4. 現状と課題の整理
- サイドバーにページがフラットに並び、目的別のまとまりがない。
- 旧ページの一部がインラインスタイル/旧APIベース等で統一感に欠ける。
- 辞書UIが `AudioIntegrity` 等に散在し、どこで編集すべきか迷う。

## 5. 方針・設計概要
### 5.1 ナビゲーション方針
- **一次メニュー（常時表示・高頻度）**
  - ダッシュボード / 企画CSV / 辞書 / サムネイル / 台本作成 / 台本・音声字幕管理
- **二次メニュー（やや頻度低・目的特化）**
  - 音声レビュー / CapCut編集 / Audio TTS v2 / 音声整合性 / レポート
- **三次メニュー（低頻度・設定/運用）**
  - プロンプト / ジョブ管理 / 設定 / チャンネル詳細設定 / LLM使用状況 など
- 実装は `AppShell.tsx` の `navItems` を段階的に **カテゴリ配列 + 折り畳みUI** に変更する。

### 5.2 辞書ハブ方針
- 辞書に関する操作は **Dictionaryページのみ** に集約。
- 旧ページでは **辞書一覧/削除UIを撤去し、リンク誘導のみ残す**。
- グローバル辞書（GKB）とチャンネル別読み辞書をタブで切り替え、検索/登録/削除を同一UIで提供。

### 5.3 スタイル統一
- ページ単位のBEMクラス + 既存のクリーンCSS（`workspace-clean.css` 等）を踏襲。
- 旧ページは「導線優先」で最低限のクリーン化のみ行い、全面刷新は後続へ回す。

## 6. 影響範囲と依存関係
- **影響UI**
  - `AppShell.tsx`（WorkspaceView/ナビ）
  - `App.tsx`（routes）
  - `AudioIntegrityPage.tsx`（辞書UI撤去・誘導）
- **依存**
  - `ui/backend/main.py` のKB/reading-dict API
  - `audio_tts_v2/tts/reading_dict.py` のYAML読み書き
- **他計画との整合**
  - 別エージェントが作成中のバックエンド大幅リファクタ計画が `ssot/` に来たら、本計画のAPI前提はそちらへ追従する。

## 7. マイルストーン / 実装ステップ
| ステージ | 具体タスク | オーナー | 期日 | ステータス |
| --- | --- | --- | --- | --- |
| 1 | Dictionaryページ作成・API追加・サイドバー導入 | AI agent | 2025-12-12 | Done |
| 2 | 旧辞書UIの撤去/誘導（AudioIntegrity 等） | AI agent | 2025-12-12 | Done |
| 3 | サイドバーのカテゴリ化（折り畳み/頻度順） | Owner+AI | TBD | Draft |
| 4 | 主要ページの見た目/文言の統一 | Owner+AI | TBD | Draft |
| 5 | QA・導線確認・リリース | Owner | TBD | Draft |

## 8. TODO / チェックリスト
- [x] 辞書ページへの統合UI追加
- [x] 旧辞書UIの撤去と導線確保
- [ ] サイドバーカテゴリ化のUIデザイン決定
- [ ] 低頻度ページの折り畳み/移動ルール確定
- [ ] 主要フローのユーザーテスト（3分で完了できるか）

## 9. 決定ログ (ADR 簡易版)
- 2025-12-12: 辞書操作はDictionaryページに集約し、他ページから撤去する方針に決定。
- 2025-12-12: サイドバー整理は「頻度×目的」でカテゴリ化し段階導入する方針に決定。

## 10. リスクと対策
- **リスク**: バックエンドの後続リファクタでAPI仕様が変わる可能性。
  - **対策**: Dictionaryページ側は `ui/frontend/src/api/client.ts` の薄いラッパ経由で吸収し、UI側の修正を局所化する。
- **リスク**: サイドバー再編で既存ユーザーが迷う可能性。
  - **対策**: まず順序/カテゴリだけ変え、パスは維持。必要なら旧表示を設定で切替可能にする。

## 11. 非対応事項 / バックログ
- AudioIntegrity等の全面的なリデザイン（旧API/インラインスタイル整理を含む）は後続。
- 各ページの機能追加（サムネ表埋め込み等）は別計画として管理。

## 12. 参照リンク
- `ui/frontend/src/pages/DictionaryPage.tsx`
- `ui/frontend/src/layouts/AppShell.tsx`
- `ui/backend/main.py`（KB/reading-dict endpoints）
