# 高品質台本生成ワークフロー（CH01 / 人生の道標）
最終更新: 2025-12-31
目的: 「自然な日本語」「再現性」「史実での証明」を両立しつつ、Aテキスト量産を事故なく安定化させる。

---

> [!IMPORTANT]
> **CH01は「架空の現代人物ストーリー禁止」**。  
> 旧版（2025-11-07）の「主人公/敵役/逆転の一言」フレームは **使用禁止**（今回の事故原因）。

## SoT（正本）
- チャンネルプロンプト: `packages/script_pipeline/prompts/channels/CH01.yaml`
  - 同期先（実運用で参照される）: `packages/script_pipeline/channels/CH01-人生の道標/script_prompt.txt`
- 構成パターン（固定）: `ssot/ops/OPS_SCRIPT_PATTERNS.yaml` の `ch01_historical_proof_bridge_v1`
- 最終Aテキスト禁則/品質ゲート: `ssot/ops/OPS_A_TEXT_GLOBAL_RULES.md`

## 1. 全体像
1. **企画インプット整備**: `scripts/ch01/generate_prompt_input.py` で、企画CSV→プロンプト入力を生成（史実エピソード候補を必ず入れる）。
2. **本文ドラフト生成**: 生成担当LLM（推奨: Claude等）に **本文だけ**を書かせる（架空人物禁止）。
3. **QA**: `scripts/ch01/check_script.py` と textlint 等で機械チェック→必要最小限の修正。
4. **最終レビュー**: 史実の断定/会話捏造/言い換え水増し/括弧多用がないかを目視で確認。

---

## 2. Step-by-Step
### Step1: 企画テンプレ生成
- コマンド例（動画番号で指定）:
  ```bash
  python3 scripts/ch01/generate_prompt_input.py \
    --number 251 \
    --reference "バズった台本４（受け流す技術）" \
    --teaching "口業/正語/忍辱" \
    --historical-episodes "織田信長と明智光秀（言葉の刃）" \
    --avoid-topics "架空の現代人物ストーリー、人物紹介（「姓名、年齢(歳/才)。」の単独行）で開始" \
    --constraints "6000-8000字相当"
  ```
- 生成されたプロンプト内の `<<INPUT TEMPLATE>>` を埋めて、本文生成担当LLMへ渡す。

### Step2: アウトライン草稿
- CH01は「史実で証明→日常へ橋渡し→実践」で固定（`ch01_historical_proof_bridge_v1`）。
- **主人公/敵役/逆転の一言の“現代会話劇”は作らない**。史実・逸話に寄せる。

### Step3: 本文ドラフト（担当LLM）
- 出力は **Aテキスト本文のみ**（要約/アウトライン/チェックリスト等は出さない）。
- 史実/逸話は1〜2件に絞り、断定は避ける（「伝えられています」「諸説あります」）。
- 架空の現代人物ストーリーは禁止（人物設定としての名前/年齢/職業/会話劇の作り込みをしない）。  
  ※史実人物の年齢言及は可。ただし人物紹介の「姓名、年齢(歳/才)。」の単独行にせず、文として書く（例: `ブッダが29歳のとき…`）。

### Step4: ハイブリッド仕上げ
1. `scripts/ch01/check_script.py` を実行（必要なら `--names` に史実人物名を渡す）。
2. 音読/TTSで「耳で不自然」な箇所だけを最小修正する。

### Step5: 品質ゲート
- チェックリスト（抜粋）
  - [ ] 史実・逸話は1〜2件で深掘り（断定しない）
  - [ ] 架空の現代人物ストーリーがない
  - [ ] 会話文の捏造がない
  - [ ] 語尾連続検出ツールOK
  - [ ] textlint警告ゼロor理由付き許容
  - [ ] `学習整理` ToDo更新

---

## 4. 実装ロードマップ
1. 企画CSV→入力生成の導線を `scripts/ch01/generate_prompt_input.py` に一本化（主人公/敵役は廃止）。
2. 本文生成は「非フィクション運用」固定（CH01 prompt + `ch01_historical_proof_bridge_v1`）。
3. QAは `scripts/ch01/check_script.py` と Aテキスト禁則で止める。

---

## 5. 参考リソース
- チャンネル正本: `packages/script_pipeline/prompts/channels/CH01.yaml`
- パターン正本: `ssot/ops/OPS_SCRIPT_PATTERNS.yaml`（`ch01_historical_proof_bridge_v1`）
- 運用: `運用マニュアル_人生の道標台本制作.md`
