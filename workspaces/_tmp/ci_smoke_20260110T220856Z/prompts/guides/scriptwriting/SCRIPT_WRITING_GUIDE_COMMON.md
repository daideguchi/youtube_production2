# SCRIPT_WRITING_GUIDE_COMMON — 台本「直接執筆」共通指示書

このガイドは、AIエージェントが「チャンネル別の SoT を参照しつつ、最終成果物＝読み台本（Aテキスト）を迷わず仕上げる」ための共通ルールです。  
まずチャンネル別ガイド `prompts/guides/scriptwriting/channels/CHxx.md` を開き、参照すべき SoT パスと既定値を確認してください。

---

## 0) 用語（迷いポイント潰し）

- `CHxx` = チャンネルID（例: `CH01`）。ユーザーが `ch01` と書いても **同義**として扱う。
- 「chapter / 第1章」などの“章”は台本内の区切りであり、チャンネルIDとは別物。曖昧なら執筆前に確認する。

## 1) 優先順位（衝突したらここに従う）

1. 入力契約（タイトルが正）: `ssot/ops/OPS_SCRIPT_INPUT_CONTRACT.md`
2. Aテキスト禁則（全チャンネル共通・最優先）: `ssot/ops/OPS_A_TEXT_GLOBAL_RULES.md`
3. チャンネル固有: 各チャンネルの `script_prompt.txt` と Persona
4. 文字数ターゲット: `configs/sources.yaml: channels.CHxx.target_chars_min/max`
5. その他補助（ベンチマーク等）: ただしタイトルと矛盾したら捨てる

## 2) 必須インプット（不足なら質問してから開始）

下を揃える。足りないものは **推測で埋めず**、質問してから執筆する。

```text
<<INPUT>>
チャンネル: CHxx
動画番号 / 動画ID:
動画タイトル（最優先）:
企画意図（何を救う/何が変わる）:
ターゲット（年齢層・悩み・状況）:
構成案メモ（任意だがあると強い）:
ベンチマーク（任意。URLは本文に入れない）:
絶対に入れたい要素（任意）:
絶対に避けたい要素（任意）:
納期/文字数などの追加制約（任意。未指定なら既定値）:
<<END>>
```

禁止（入力側）:
- 旧台本の全文コピペ、制作メモの羅列、URL/脚注付き資料の貼り付け（内容汚染の原因）

## 3) デフォルトの出力（最終成果物）

デフォルトは「読み台本（Aテキスト）」本文のみを出力する。  
アウトライン/要約が必要なら **ユーザーが明示したときだけ**、本文と混ぜずに別ブロックで出す。

Aテキスト禁則（抜粋。詳細は `ssot/ops/OPS_A_TEXT_GLOBAL_RULES.md`）:
- URL/脚注/出典メタ 0
- 丸括弧 `（ ）` / `( )` 0
- 箇条書き/番号リスト/Markdown装飾/見出し行 なし
- ポーズは `---` のみ（1行単独）。**等間隔分割は禁止**。文脈ベースで最小限。

実務メモ（迷いが出やすいところ）:
- 箇条書きにしたくなったら、本文では「一つ目は…」「次に…」「最後に…」のように地の文で列挙する（先頭に `-` や `・` を付けない）。
- 補足やふりがなを入れたくなっても、丸括弧は使わず地の文に溶かす（例: `難しい言葉（やさしく言うと…）` → `難しい言葉を、やさしく言うと…`）。
- 見出しを書きたくなっても、本文では “見出し行” を作らない（段落の最初を自然に転換させる）。
- 間（ポーズ）を入れたい場合は `---` だけを使う（`（間）` などの丸括弧は禁止）。
- 読み間違い防止のため、人を指す「方」はできるだけ「人」に言い換える。

## 4) 執筆フロー（内部手順）

1. チャンネル別ガイドで SoT パスと既定値（目標文字数など）を確認する。
2. Persona + channel `script_prompt.txt` を読み、トーン・必須要素・NGを固定する。
3. タイトルを “正” として、内部でアウトラインを作る（原則、出力しない）。
4. 本文を書く（Aテキスト禁則を満たす）。大きな話題転換だけ `---` を使う（機械的等間隔は禁止）。
5. TODOチェック → 必要なら自分で修正してから提出する。

## 5) TODO（提出前セルフチェック）

- [ ] タイトル趣旨から逸脱していない（矛盾する補助情報は捨てた）
- [ ] 目標文字数レンジに収まっている（概算でOK）
- [ ] URL/脚注/出典メタが本文に無い
- [ ] 丸括弧が0個
- [ ] 箇条書き/番号リスト/Markdown装飾/見出し行が無い
- [ ] `---` は文脈ベースで最小限（等間隔で入れていない）
- [ ] 同一段落の重複が無い（言い換え水増しではなく具体で厚み）
- [ ] 統計/研究/機関名/数字を捏造していない
- [ ] 最後まで完結している（ぶつ切りで終わっていない）
- [ ] `�`（文字化け）や不自然な記号が混入していない
- [ ] チャンネル固有の必須要素（物語/教え/実践/締め等）を満たす

## 6) よくある事故（禁止）

- 台本本文に「アウトライン」「制作メモ」「QA」「字数メモ」を混ぜる
- ベンチマークURLを本文に書く（字幕/読み上げ事故）
- 区切りを `***` / `___` / `===` などで入れる（禁止）
- 秒数/文字数に合わせて等間隔で区切る（禁止）

## 7) 仕上げの品質ループ（任意）

可能なら、本文を出す前にセルフレビュー→最小修正を行う（本文を書き換えすぎない）。

- Judge: `packages/script_pipeline/prompts/a_text_quality_judge_prompt.txt`
- Fix（最小修正）: `packages/script_pipeline/prompts/a_text_quality_fix_prompt.txt`
- 最終磨き: `packages/script_pipeline/prompts/a_text_final_polish_prompt.txt`
